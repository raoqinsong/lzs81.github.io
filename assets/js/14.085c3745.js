(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{476:function(n,s,e){"use strict";e.r(s);var a=e(2),t=Object(a.a)({},(function(){var n=this,s=n.$createElement,e=n._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h2",{attrs:{id:"获取上传签名代码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#获取上传签名代码"}},[n._v("#")]),n._v(" 获取上传签名代码")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v(' /**\n     * 获取签名\n     * @return\n     */\n    public OssSignature getSignature(OSSClient ossClient,OssProperties ossProperties,String fileName) {\n        /**\n        * host的格式为 bucket .endpoint\n        */\n        String host = "";\n        if (StringUtils.isBlank(ossProperties.getHost())){\n             host = "http://" + ossProperties.getBucketName() + "." + ossProperties.getEndpoint();\n        }else{\n            host = ossProperties.getHost();\n        }\n\n        String dir = ossProperties.getDir();\n        String str = "/";\n        if (!dir.contains(str)){\n            dir = dir + str;\n        }\n\n        OssSignature ossSignature = new OssSignature();\n        try {\n            long expireTime = 30;\n            if(StringUtils.isNotBlank(ossProperties.getExpire())){\n                expireTime = Long.parseLong(ossProperties.getExpire());\n            }\n\n            long expireEndTime = System.currentTimeMillis() + expireTime * 1000;\n            Date expiration = new Date(expireEndTime);\n            PolicyConditions policyConds = new PolicyConditions();\n            policyConds.addConditionItem(PolicyConditions.COND_CONTENT_LENGTH_RANGE, 0, 1048576000);\n            policyConds.addConditionItem(MatchMode.Exact, PolicyConditions.COND_KEY, fileName);\n\n            String postPolicy = ossClient.generatePostPolicy(expiration, policyConds);\n            byte[] binaryData = postPolicy.getBytes("utf-8");\n            String encodedPolicy = BinaryUtil.toBase64String(binaryData);\n            String postSignature = ossClient.calculatePostSignature(postPolicy);\n\n\n\n            ossSignature.setAccessKeyId(ossProperties.getAccessKeyId());\n            ossSignature.setPolicy(encodedPolicy);\n            ossSignature.setSignature(postSignature);\n            ossSignature.setDir(fileName);\n            ossSignature.setHost(host);\n            ossSignature.setExpire(String.valueOf(expireEndTime / 1000));\n\n            JSONObject jasonCallback = new JSONObject();\n            jasonCallback.put("callbackUrl", ossProperties.getCallback());\n            jasonCallback.put("callbackBody",\n                    "filename=${object}&size=${size}&mimeType=${mimeType}&height=${imageInfo.height}&width=${imageInfo.width}");\n            jasonCallback.put("callbackBodyType", "application/x-www-form-urlencoded");\n            String base64CallbackBody = BinaryUtil.toBase64String(jasonCallback.toString().getBytes("utf-8"));\n\n            ossSignature.setCallback(base64CallbackBody);\n\n        } catch (Exception e) {\n            log.error("获取签名失败:",e);\n        }\n        return ossSignature;\n    }\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br"),e("span",{staticClass:"line-number"},[n._v("31")]),e("br"),e("span",{staticClass:"line-number"},[n._v("32")]),e("br"),e("span",{staticClass:"line-number"},[n._v("33")]),e("br"),e("span",{staticClass:"line-number"},[n._v("34")]),e("br"),e("span",{staticClass:"line-number"},[n._v("35")]),e("br"),e("span",{staticClass:"line-number"},[n._v("36")]),e("br"),e("span",{staticClass:"line-number"},[n._v("37")]),e("br"),e("span",{staticClass:"line-number"},[n._v("38")]),e("br"),e("span",{staticClass:"line-number"},[n._v("39")]),e("br"),e("span",{staticClass:"line-number"},[n._v("40")]),e("br"),e("span",{staticClass:"line-number"},[n._v("41")]),e("br"),e("span",{staticClass:"line-number"},[n._v("42")]),e("br"),e("span",{staticClass:"line-number"},[n._v("43")]),e("br"),e("span",{staticClass:"line-number"},[n._v("44")]),e("br"),e("span",{staticClass:"line-number"},[n._v("45")]),e("br"),e("span",{staticClass:"line-number"},[n._v("46")]),e("br"),e("span",{staticClass:"line-number"},[n._v("47")]),e("br"),e("span",{staticClass:"line-number"},[n._v("48")]),e("br"),e("span",{staticClass:"line-number"},[n._v("49")]),e("br"),e("span",{staticClass:"line-number"},[n._v("50")]),e("br"),e("span",{staticClass:"line-number"},[n._v("51")]),e("br"),e("span",{staticClass:"line-number"},[n._v("52")]),e("br"),e("span",{staticClass:"line-number"},[n._v("53")]),e("br"),e("span",{staticClass:"line-number"},[n._v("54")]),e("br"),e("span",{staticClass:"line-number"},[n._v("55")]),e("br"),e("span",{staticClass:"line-number"},[n._v("56")]),e("br"),e("span",{staticClass:"line-number"},[n._v("57")]),e("br"),e("span",{staticClass:"line-number"},[n._v("58")]),e("br"),e("span",{staticClass:"line-number"},[n._v("59")]),e("br"),e("span",{staticClass:"line-number"},[n._v("60")]),e("br"),e("span",{staticClass:"line-number"},[n._v("61")]),e("br"),e("span",{staticClass:"line-number"},[n._v("62")]),e("br")])]),e("p",[e("code",[n._v("因为上传回调需要外网访问本机的地址，所以可以不用写回调地址。前端判断响应状态码为200，则为成功。具体前端如何做")]),e("a",{attrs:{href:"https://blog.lzs81.cn/blogs/Vue/oss%E5%89%8D%E7%AB%AF%E7%9B%B4%E4%BC%A0.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("参考前端上传代码"),e("OutboundLink")],1)]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('    /**\n     * 获取public key\n     *\n     * @param url\n     * @return\n     */\n    public String executeGet(String url) {\n        BufferedReader in = null;\n\n        String content = null;\n        try {\n            // 定义HttpClient\n            @SuppressWarnings("resource")\n            HttpClient client =  HttpClientBuilder.create().build();\n            // 实例化HTTP方法\n            HttpGet request = new HttpGet();\n            request.setURI(new URI(url));\n            HttpResponse response = client.execute(request);\n\n            in = new BufferedReader(new InputStreamReader(response.getEntity().getContent()));\n            StringBuffer sb = new StringBuffer("");\n            String line = "";\n            String nL = System.getProperty("line.separator");\n            while ((line = in.readLine()) != null) {\n                sb.append(line + nL);\n            }\n            in.close();\n            content = sb.toString();\n            return content;\n        } catch (Exception e) {\n            log.error("获取public key:",e);\n            return "";\n        } finally {\n            if (in != null) {\n                try {\n                    in.close();// 最后要关闭BufferedReader\n                } catch (Exception e) {\n                    log.error("关闭BufferedReader:",e);\n                }\n            }\n        }\n    }\n\n    /**\n     * 获取Post消息体\n     *\n     * @param is\n     * @param contentLen\n     * @return\n     */\n    public String getPostBody(InputStream is, int contentLen) {\n        if (contentLen > 0) {\n            int readLen = 0;\n            int readLengthThisTime = 0;\n            byte[] message = new byte[contentLen];\n            try {\n                while (readLen != contentLen) {\n                    readLengthThisTime = is.read(message, readLen, contentLen - readLen);\n                    /* Should not happen.*/\n                    if (readLengthThisTime == -1) {\n                        break;\n                    }\n                    readLen += readLengthThisTime;\n                }\n                return new String(message);\n            } catch (IOException e) {\n                log.error("获取Post消息体失败:",e);\n            }\n        }\n        return "";\n    }\n\n    /**\n     * 验证上传回调的Request\n     *\n     * @param request\n     * @param ossCallbackBody\n     * @return\n     * @throws NumberFormatException\n     * @throws IOException\n     */\n    protected boolean verifyOSSCallbackRequest(HttpServletRequest request, String ossCallbackBody)\n            throws NumberFormatException, IOException {\n        boolean ret = false;\n        String autorizationInput = new String(request.getHeader("Authorization"));\n        if (StringUtils.isBlank(autorizationInput)){\n            return false;\n        }\n        String pubKeyInput = request.getHeader("x-oss-pub-key-url");\n        byte[] authorization = BinaryUtil.fromBase64String(autorizationInput);\n        byte[] pubKey = BinaryUtil.fromBase64String(pubKeyInput);\n        String pubKeyAddr = new String(pubKey);\n        String http = "http://gosspublic.alicdn.com/";\n        String https = "https://gosspublic.alicdn.com/";\n        if (!pubKeyAddr.startsWith(http)\n                && !pubKeyAddr.startsWith(https)) {\n            System.out.println("pub key addr must be oss addrss");\n            return false;\n        }\n        String retString = executeGet(pubKeyAddr);\n        retString = retString.replace("-----BEGIN PUBLIC KEY-----", "");\n        retString = retString.replace("-----END PUBLIC KEY-----", "");\n        String queryString = request.getQueryString();\n        String uri = request.getRequestURI();\n        String decodeUri = java.net.URLDecoder.decode(uri, "UTF-8");\n        String authStr = decodeUri;\n        if (queryString != null && !"".equals(queryString)) {\n            authStr += "?" + queryString;\n        }\n        authStr += "\\n" + ossCallbackBody;\n        ret = doCheck(authStr, authorization, retString);\n        return ret;\n    }\n\n    /**\n     * Post请求\n     */\n    public void callback(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n        String ossCallbackBody = getPostBody(request.getInputStream(),\n                Integer.parseInt(request.getHeader("content-length")));\n        boolean ret = verifyOSSCallbackRequest(request, ossCallbackBody);\n        ///System.out.println("verify result : " + ret);\n        if (ret) {\n            response(request, response, "{\\"Status\\":\\"OK\\"}", HttpServletResponse.SC_OK);\n        } else {\n            response(request, response, "{\\"Status\\":\\"verdify not ok\\"}", HttpServletResponse.SC_BAD_REQUEST);\n        }\n    }\n\n    /**\n     * 验证RSA\n     *\n     * @param content\n     * @param sign\n     * @param publicKey\n     * @return\n     */\n    public static boolean doCheck(String content, byte[] sign, String publicKey) {\n        try {\n            KeyFactory keyFactory = KeyFactory.getInstance("RSA");\n            byte[] encodedKey = BinaryUtil.fromBase64String(publicKey);\n            PublicKey pubKey = keyFactory.generatePublic(new X509EncodedKeySpec(encodedKey));\n            java.security.Signature signature = java.security.Signature.getInstance("MD5withRSA");\n            signature.initVerify(pubKey);\n            signature.update(content.getBytes());\n            boolean bverify = signature.verify(sign);\n            return bverify;\n\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n\n        return false;\n    }\n\n    /**\n     * 服务器响应结果\n     *\n     * @param request\n     * @param response\n     * @param results\n     * @param status\n     * @throws IOException\n     */\n    private void response(HttpServletRequest request, HttpServletResponse response, String results, int status)\n            throws IOException {\n        String callbackFunName = request.getParameter("callback");\n        response.addHeader("Content-Length", String.valueOf(results.length()));\n        if (callbackFunName == null || "".equalsIgnoreCase(callbackFunName)){\n            response.getWriter().println(results);\n        }\n        else{\n            response.getWriter().println(callbackFunName + "( " + results + " )");\n        }\n        response.setStatus(status);\n        response.flushBuffer();\n    }\n\n    /**\n     * 服务器响应结果\n     */\n    private void response(HttpServletRequest request, HttpServletResponse response, String results) throws IOException {\n        String callbackFunName = request.getParameter("callback");\n        if (callbackFunName == null || "".equalsIgnoreCase(callbackFunName)){\n            response.getWriter().println(results);\n        }\n        else{\n            response.getWriter().println(callbackFunName + "( " + results + " )");\n        }\n        response.setStatus(HttpServletResponse.SC_OK);\n        response.flushBuffer();\n    }\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br"),e("span",{staticClass:"line-number"},[n._v("31")]),e("br"),e("span",{staticClass:"line-number"},[n._v("32")]),e("br"),e("span",{staticClass:"line-number"},[n._v("33")]),e("br"),e("span",{staticClass:"line-number"},[n._v("34")]),e("br"),e("span",{staticClass:"line-number"},[n._v("35")]),e("br"),e("span",{staticClass:"line-number"},[n._v("36")]),e("br"),e("span",{staticClass:"line-number"},[n._v("37")]),e("br"),e("span",{staticClass:"line-number"},[n._v("38")]),e("br"),e("span",{staticClass:"line-number"},[n._v("39")]),e("br"),e("span",{staticClass:"line-number"},[n._v("40")]),e("br"),e("span",{staticClass:"line-number"},[n._v("41")]),e("br"),e("span",{staticClass:"line-number"},[n._v("42")]),e("br"),e("span",{staticClass:"line-number"},[n._v("43")]),e("br"),e("span",{staticClass:"line-number"},[n._v("44")]),e("br"),e("span",{staticClass:"line-number"},[n._v("45")]),e("br"),e("span",{staticClass:"line-number"},[n._v("46")]),e("br"),e("span",{staticClass:"line-number"},[n._v("47")]),e("br"),e("span",{staticClass:"line-number"},[n._v("48")]),e("br"),e("span",{staticClass:"line-number"},[n._v("49")]),e("br"),e("span",{staticClass:"line-number"},[n._v("50")]),e("br"),e("span",{staticClass:"line-number"},[n._v("51")]),e("br"),e("span",{staticClass:"line-number"},[n._v("52")]),e("br"),e("span",{staticClass:"line-number"},[n._v("53")]),e("br"),e("span",{staticClass:"line-number"},[n._v("54")]),e("br"),e("span",{staticClass:"line-number"},[n._v("55")]),e("br"),e("span",{staticClass:"line-number"},[n._v("56")]),e("br"),e("span",{staticClass:"line-number"},[n._v("57")]),e("br"),e("span",{staticClass:"line-number"},[n._v("58")]),e("br"),e("span",{staticClass:"line-number"},[n._v("59")]),e("br"),e("span",{staticClass:"line-number"},[n._v("60")]),e("br"),e("span",{staticClass:"line-number"},[n._v("61")]),e("br"),e("span",{staticClass:"line-number"},[n._v("62")]),e("br"),e("span",{staticClass:"line-number"},[n._v("63")]),e("br"),e("span",{staticClass:"line-number"},[n._v("64")]),e("br"),e("span",{staticClass:"line-number"},[n._v("65")]),e("br"),e("span",{staticClass:"line-number"},[n._v("66")]),e("br"),e("span",{staticClass:"line-number"},[n._v("67")]),e("br"),e("span",{staticClass:"line-number"},[n._v("68")]),e("br"),e("span",{staticClass:"line-number"},[n._v("69")]),e("br"),e("span",{staticClass:"line-number"},[n._v("70")]),e("br"),e("span",{staticClass:"line-number"},[n._v("71")]),e("br"),e("span",{staticClass:"line-number"},[n._v("72")]),e("br"),e("span",{staticClass:"line-number"},[n._v("73")]),e("br"),e("span",{staticClass:"line-number"},[n._v("74")]),e("br"),e("span",{staticClass:"line-number"},[n._v("75")]),e("br"),e("span",{staticClass:"line-number"},[n._v("76")]),e("br"),e("span",{staticClass:"line-number"},[n._v("77")]),e("br"),e("span",{staticClass:"line-number"},[n._v("78")]),e("br"),e("span",{staticClass:"line-number"},[n._v("79")]),e("br"),e("span",{staticClass:"line-number"},[n._v("80")]),e("br"),e("span",{staticClass:"line-number"},[n._v("81")]),e("br"),e("span",{staticClass:"line-number"},[n._v("82")]),e("br"),e("span",{staticClass:"line-number"},[n._v("83")]),e("br"),e("span",{staticClass:"line-number"},[n._v("84")]),e("br"),e("span",{staticClass:"line-number"},[n._v("85")]),e("br"),e("span",{staticClass:"line-number"},[n._v("86")]),e("br"),e("span",{staticClass:"line-number"},[n._v("87")]),e("br"),e("span",{staticClass:"line-number"},[n._v("88")]),e("br"),e("span",{staticClass:"line-number"},[n._v("89")]),e("br"),e("span",{staticClass:"line-number"},[n._v("90")]),e("br"),e("span",{staticClass:"line-number"},[n._v("91")]),e("br"),e("span",{staticClass:"line-number"},[n._v("92")]),e("br"),e("span",{staticClass:"line-number"},[n._v("93")]),e("br"),e("span",{staticClass:"line-number"},[n._v("94")]),e("br"),e("span",{staticClass:"line-number"},[n._v("95")]),e("br"),e("span",{staticClass:"line-number"},[n._v("96")]),e("br"),e("span",{staticClass:"line-number"},[n._v("97")]),e("br"),e("span",{staticClass:"line-number"},[n._v("98")]),e("br"),e("span",{staticClass:"line-number"},[n._v("99")]),e("br"),e("span",{staticClass:"line-number"},[n._v("100")]),e("br"),e("span",{staticClass:"line-number"},[n._v("101")]),e("br"),e("span",{staticClass:"line-number"},[n._v("102")]),e("br"),e("span",{staticClass:"line-number"},[n._v("103")]),e("br"),e("span",{staticClass:"line-number"},[n._v("104")]),e("br"),e("span",{staticClass:"line-number"},[n._v("105")]),e("br"),e("span",{staticClass:"line-number"},[n._v("106")]),e("br"),e("span",{staticClass:"line-number"},[n._v("107")]),e("br"),e("span",{staticClass:"line-number"},[n._v("108")]),e("br"),e("span",{staticClass:"line-number"},[n._v("109")]),e("br"),e("span",{staticClass:"line-number"},[n._v("110")]),e("br"),e("span",{staticClass:"line-number"},[n._v("111")]),e("br"),e("span",{staticClass:"line-number"},[n._v("112")]),e("br"),e("span",{staticClass:"line-number"},[n._v("113")]),e("br"),e("span",{staticClass:"line-number"},[n._v("114")]),e("br"),e("span",{staticClass:"line-number"},[n._v("115")]),e("br"),e("span",{staticClass:"line-number"},[n._v("116")]),e("br"),e("span",{staticClass:"line-number"},[n._v("117")]),e("br"),e("span",{staticClass:"line-number"},[n._v("118")]),e("br"),e("span",{staticClass:"line-number"},[n._v("119")]),e("br"),e("span",{staticClass:"line-number"},[n._v("120")]),e("br"),e("span",{staticClass:"line-number"},[n._v("121")]),e("br"),e("span",{staticClass:"line-number"},[n._v("122")]),e("br"),e("span",{staticClass:"line-number"},[n._v("123")]),e("br"),e("span",{staticClass:"line-number"},[n._v("124")]),e("br"),e("span",{staticClass:"line-number"},[n._v("125")]),e("br"),e("span",{staticClass:"line-number"},[n._v("126")]),e("br"),e("span",{staticClass:"line-number"},[n._v("127")]),e("br"),e("span",{staticClass:"line-number"},[n._v("128")]),e("br"),e("span",{staticClass:"line-number"},[n._v("129")]),e("br"),e("span",{staticClass:"line-number"},[n._v("130")]),e("br"),e("span",{staticClass:"line-number"},[n._v("131")]),e("br"),e("span",{staticClass:"line-number"},[n._v("132")]),e("br"),e("span",{staticClass:"line-number"},[n._v("133")]),e("br"),e("span",{staticClass:"line-number"},[n._v("134")]),e("br"),e("span",{staticClass:"line-number"},[n._v("135")]),e("br"),e("span",{staticClass:"line-number"},[n._v("136")]),e("br"),e("span",{staticClass:"line-number"},[n._v("137")]),e("br"),e("span",{staticClass:"line-number"},[n._v("138")]),e("br"),e("span",{staticClass:"line-number"},[n._v("139")]),e("br"),e("span",{staticClass:"line-number"},[n._v("140")]),e("br"),e("span",{staticClass:"line-number"},[n._v("141")]),e("br"),e("span",{staticClass:"line-number"},[n._v("142")]),e("br"),e("span",{staticClass:"line-number"},[n._v("143")]),e("br"),e("span",{staticClass:"line-number"},[n._v("144")]),e("br"),e("span",{staticClass:"line-number"},[n._v("145")]),e("br"),e("span",{staticClass:"line-number"},[n._v("146")]),e("br"),e("span",{staticClass:"line-number"},[n._v("147")]),e("br"),e("span",{staticClass:"line-number"},[n._v("148")]),e("br"),e("span",{staticClass:"line-number"},[n._v("149")]),e("br"),e("span",{staticClass:"line-number"},[n._v("150")]),e("br"),e("span",{staticClass:"line-number"},[n._v("151")]),e("br"),e("span",{staticClass:"line-number"},[n._v("152")]),e("br"),e("span",{staticClass:"line-number"},[n._v("153")]),e("br"),e("span",{staticClass:"line-number"},[n._v("154")]),e("br"),e("span",{staticClass:"line-number"},[n._v("155")]),e("br"),e("span",{staticClass:"line-number"},[n._v("156")]),e("br"),e("span",{staticClass:"line-number"},[n._v("157")]),e("br"),e("span",{staticClass:"line-number"},[n._v("158")]),e("br"),e("span",{staticClass:"line-number"},[n._v("159")]),e("br"),e("span",{staticClass:"line-number"},[n._v("160")]),e("br"),e("span",{staticClass:"line-number"},[n._v("161")]),e("br"),e("span",{staticClass:"line-number"},[n._v("162")]),e("br"),e("span",{staticClass:"line-number"},[n._v("163")]),e("br"),e("span",{staticClass:"line-number"},[n._v("164")]),e("br"),e("span",{staticClass:"line-number"},[n._v("165")]),e("br"),e("span",{staticClass:"line-number"},[n._v("166")]),e("br"),e("span",{staticClass:"line-number"},[n._v("167")]),e("br"),e("span",{staticClass:"line-number"},[n._v("168")]),e("br"),e("span",{staticClass:"line-number"},[n._v("169")]),e("br"),e("span",{staticClass:"line-number"},[n._v("170")]),e("br"),e("span",{staticClass:"line-number"},[n._v("171")]),e("br"),e("span",{staticClass:"line-number"},[n._v("172")]),e("br"),e("span",{staticClass:"line-number"},[n._v("173")]),e("br"),e("span",{staticClass:"line-number"},[n._v("174")]),e("br"),e("span",{staticClass:"line-number"},[n._v("175")]),e("br"),e("span",{staticClass:"line-number"},[n._v("176")]),e("br"),e("span",{staticClass:"line-number"},[n._v("177")]),e("br"),e("span",{staticClass:"line-number"},[n._v("178")]),e("br"),e("span",{staticClass:"line-number"},[n._v("179")]),e("br"),e("span",{staticClass:"line-number"},[n._v("180")]),e("br"),e("span",{staticClass:"line-number"},[n._v("181")]),e("br"),e("span",{staticClass:"line-number"},[n._v("182")]),e("br"),e("span",{staticClass:"line-number"},[n._v("183")]),e("br"),e("span",{staticClass:"line-number"},[n._v("184")]),e("br"),e("span",{staticClass:"line-number"},[n._v("185")]),e("br"),e("span",{staticClass:"line-number"},[n._v("186")]),e("br"),e("span",{staticClass:"line-number"},[n._v("187")]),e("br"),e("span",{staticClass:"line-number"},[n._v("188")]),e("br"),e("span",{staticClass:"line-number"},[n._v("189")]),e("br"),e("span",{staticClass:"line-number"},[n._v("190")]),e("br"),e("span",{staticClass:"line-number"},[n._v("191")]),e("br"),e("span",{staticClass:"line-number"},[n._v("192")]),e("br"),e("span",{staticClass:"line-number"},[n._v("193")]),e("br")])]),e("h2",{attrs:{id:"使用说明"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用说明"}},[n._v("#")]),n._v(" 使用说明")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('@SpringBootApplication\n@EnableAliyunOss\n@EnableSwagger2Doc\n@RestController\npublic class Application {\n    public static void main(String[] args) {\n        SpringApplication.run(Application.class, args);\n    }\n    \n        @Autowired\n        private OssProperties aliyunOssProperties;\n        @Autowired\n        private OSSClient ossClient;\n    \n        @ApiOperation("临时授权")\n    @PostMapping("/getSignature")\n    public OssSignature<String> getSignature(@RequestParam("orgFileName") String orgFileName) {\n\n        String id = UuidUtils.createId();\n        String str = "/";\n        String dir = ossProperties.getDir();\n        if (!dir.contains(str)){\n            dir = dir+str;\n        }\n        String ext = orgFileName.substring(orgFileName.lastIndexOf("."));\n\n        String newFileName = dir + id + ext;\n\n        OssSignature<String> signature = new OssClientManager().getSignature(ossClient, ossProperties,newFileName);\n\n        signature.setData(dir);\n        return signature;\n    }\n\n\n\n    /**\n     * Post请求\n     */\n    @GetMapping("/callback")\n    public void callback(HttpServletRequest request, HttpServletResponse response)\n            throws ServletException, IOException {\n        new OssClientManager().callback(request,response);\n        }\n    }\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br"),e("span",{staticClass:"line-number"},[n._v("31")]),e("br"),e("span",{staticClass:"line-number"},[n._v("32")]),e("br"),e("span",{staticClass:"line-number"},[n._v("33")]),e("br"),e("span",{staticClass:"line-number"},[n._v("34")]),e("br"),e("span",{staticClass:"line-number"},[n._v("35")]),e("br"),e("span",{staticClass:"line-number"},[n._v("36")]),e("br"),e("span",{staticClass:"line-number"},[n._v("37")]),e("br"),e("span",{staticClass:"line-number"},[n._v("38")]),e("br"),e("span",{staticClass:"line-number"},[n._v("39")]),e("br"),e("span",{staticClass:"line-number"},[n._v("40")]),e("br"),e("span",{staticClass:"line-number"},[n._v("41")]),e("br"),e("span",{staticClass:"line-number"},[n._v("42")]),e("br"),e("span",{staticClass:"line-number"},[n._v("43")]),e("br"),e("span",{staticClass:"line-number"},[n._v("44")]),e("br"),e("span",{staticClass:"line-number"},[n._v("45")]),e("br")])]),e("p",[e("a",{attrs:{href:"https://gitee.com/raoqinsong/oss-starter",target:"_blank",rel:"noopener noreferrer"}},[n._v("码云"),e("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=t.exports}}]);